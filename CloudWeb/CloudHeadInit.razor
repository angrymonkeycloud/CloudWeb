@namespace AngryMonkey.CloudWeb

@inject CloudWebConfig cloudWeb
@inject CloudPage CloudPage

<CloudHead CloudPage="PageConfig" />
<CloudBundles CloudPage="PageConfig" />

@code {
    // [Parameter] public required CloudPage CloudPage { get; set; }

    protected CloudPage PageConfig
    {
        get
        {
            CloudPage ??= new();

            CloudPage config = new()
                {
                    // Nullable

                    Title = CloudPage.Title,
                    Keywords = CloudPage.Keywords ?? cloudWeb.PageDefaults.Keywords,
                    Description = CloudPage.Description ?? cloudWeb.PageDefaults.Description,
                    TitleAddOns = CloudPage.TitleAddOns ?? cloudWeb.PageDefaults.TitleAddOns,
                    CallingAssemblyName = CloudPage.CallingAssemblyName ?? cloudWeb.PageDefaults.CallingAssemblyName,

                    // Not Nullable

                    Favicon = CloudPage.Favicon ?? cloudWeb.PageDefaults.Favicon ?? "/favicon.ico",
                    BaseUrl = CloudPage.BaseUrl ?? cloudWeb.PageDefaults.BaseUrl ?? "/",
                    IndexPage = CloudPage.IndexPage ?? cloudWeb.PageDefaults.IndexPage ?? true,
                    FollowPage = CloudPage.FollowPage ?? cloudWeb.PageDefaults.FollowPage ?? true,
                    IsCrawler = CloudPage.IsCrawler ?? cloudWeb.PageDefaults.IsCrawler ?? false,
                    AutoAppendBlazorStyles = CloudPage.AutoAppendBlazorStyles ?? cloudWeb.PageDefaults.AutoAppendBlazorStyles ?? false,
                };

            config.Bundles = new(cloudWeb.PageDefaults.Bundles);
            config.Bundles.AddRange(CloudPage.Bundles);

            config.Features = new(cloudWeb.PageDefaults.Features);
            config.Features.AddRange(CloudPage.Features);

            return config;
        }
    }
}